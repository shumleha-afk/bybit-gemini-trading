—Ç–ª–∏—á–Ω–æ ‚Äî —Ç–µ–ø–µ—Ä—å –º—ã —Ç–æ—á–Ω–æ –∑–Ω–∞–µ–º, –≤ —á—ë–º –ø—Ä–æ–±–ª–µ–º–∞! üéØ

‚ùóÔ∏è–û—à–∏–±–∫–∞:
403 Client Error: Forbidden for url: https://api.bybit.com/v5/market/kline?... 

–≠—Ç–æ –æ–∑–Ω–∞—á–∞–µ—Ç, —á—Ç–æ Bybit –∑–∞–ø—Ä–µ—Ç–∏–ª –≤–∞—à –∑–∞–ø—Ä–æ—Å ‚Äî –¥–∞–∂–µ –µ—Å–ª–∏ –≤—ã –Ω–µ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç–µ API-–∫–ª—é—á (–ø—É–±–ª–∏—á–Ω—ã–π API).

üîç –ü–æ—á–µ–º—É —Ç–∞–∫?
Bybit –æ–≥—Ä–∞–Ω–∏—á–∏–≤–∞–µ—Ç —á–∞—Å—Ç–æ—Ç—É –∑–∞–ø—Ä–æ—Å–æ–≤ –∏ –º–æ–∂–µ—Ç –±–ª–æ–∫–∏—Ä–æ–≤–∞—Ç—å IP, –µ—Å–ª–∏:

–ó–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç —Å –æ–¥–Ω–æ–≥–æ IP —Å–ª–∏—à–∫–æ–º —á–∞—Å—Ç–æ,
–ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –Ω–µ–ø—Ä–∞–≤–∏–ª—å–Ω—ã–π User-Agent,
–ó–∞–ø—Ä–æ—Å—ã –∏–¥—É—Ç —á–µ—Ä–µ–∑ –ø—Ä–æ–∫—Å–∏ –∏–ª–∏ –≤–µ–±-–∏–Ω—Ç–µ—Ä—Ñ–µ–π—Å (Streamlit),
–ò–ª–∏ Bybit –ø—Ä–æ—Å—Ç–æ —Ä–µ—à–∏–ª –æ–≥—Ä–∞–Ω–∏—á–∏—Ç—å –ø—É–±–ª–∏—á–Ω—ã–π API –¥–ª—è –∑–∞—â–∏—Ç—ã –æ—Ç —Å–ø–∞–º–∞.
‚úÖ –†–µ—à–µ–Ω–∏–µ: –î–æ–±–∞–≤—å—Ç–µ User-Agent –≤ –∑–∞–ø—Ä–æ—Å
Bybit —Ç—Ä–µ–±—É–µ—Ç, —á—Ç–æ–±—ã –≤—ã –æ—Ç–ø—Ä–∞–≤–ª—è–ª–∏ –∑–∞–≥–æ–ª–æ–≤–æ–∫ User-Agent, –∫–∞–∫ –±—É–¥—Ç–æ –≤—ã –±—Ä–∞—É–∑–µ—Ä.

–®–∞–≥ 1: –ò–∑–º–µ–Ω–∏—Ç–µ –∫–æ–¥ –≤ app.py
–ù–∞–π–¥–∏—Ç–µ –±–ª–æ–∫ —Å requests.get(...) –∏ –¥–æ–±–∞–≤—å—Ç–µ –∑–∞–≥–æ–ª–æ–≤–∫–∏:

python–ø–∏—Ç–æ–Ω


1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
‚åÑ
‚åÑ
‚åÑ
# –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–≤–µ—á–∏ —Å Bybit
url = "https://api.bybit.com/v5/market/kline"
params = {
    "category": "linear",
    "symbol": symbol,
    "interval": "60",
    "limit": 20
}

# üîß –î–æ–±–∞–≤–ª—è–µ–º User-Agent ‚Äî –∏–º–∏—Ç–∏—Ä—É–µ–º –±—Ä–∞—É–∑–µ—Ä
headers = {
    "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
}

try:
    resp = requests.get(url, params=params, headers=headers, timeout=10)
    resp.raise_for_status()
‚úÖ –ü–æ–ª–Ω—ã–π –∏—Å–ø—Ä–∞–≤–ª–µ–Ω–Ω—ã–π –±–ª–æ–∫ (–∑–∞–º–µ–Ω–∏—Ç–µ –µ–≥–æ –≤ app.py)
–ó–∞–º–µ–Ω–∏—Ç–µ –≤–µ—Å—å –±–ª–æ–∫ –ø–æ—Å–ª–µ if st.button("ü§ñ –ü–æ–ª—É—á–∏—Ç—å AI-–∞–Ω–∞–ª–∏–∑ –æ—Ç Gemini"): –Ω–∞ —ç—Ç–æ—Ç:

python–ø–∏—Ç–æ–Ω


1
2
3
4
5
6
7
8
9
10
11
12
13
14
15
16
17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35
36
37
38
39
40
41
42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64
65
66
67
‚åÑ
‚åÑ
‚åÑ
‚åÑ
‚åÑ
‚åÑ
‚åÑ
‚åÑ
‚åÑ
if st.button("ü§ñ –ü–æ–ª—É—á–∏—Ç—å AI-–∞–Ω–∞–ª–∏–∑ –æ—Ç Gemini"):
    with st.spinner("–ó–∞–ø—Ä–∞—à–∏–≤–∞–µ–º –¥–∞–Ω–Ω—ã–µ —Å Bybit –∏ –∞–Ω–∞–ª–∏–∑–∏—Ä—É–µ–º —á–µ—Ä–µ–∑ Gemini..."):
        try:
            # –ü–æ–ª—É—á–∞–µ–º –ø–æ—Å–ª–µ–¥–Ω–∏–µ —Å–≤–µ—á–∏ —Å Bybit
            url = "https://api.bybit.com/v5/market/kline"
            params = {
                "category": "linear",
                "symbol": symbol,
                "interval": "60",
                "limit": 20
            }
            
            # üîß –î–æ–±–∞–≤–ª—è–µ–º User-Agent ‚Äî –∏–º–∏—Ç–∏—Ä—É–µ–º –±—Ä–∞—É–∑–µ—Ä
            headers = {
                "User-Agent": "Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/120.0.0.0 Safari/537.36"
            }
            
            # üîç –û—Ç–ª–∞–¥–∫–∞: –ø–æ–∫–∞–∂–µ–º URL –∑–∞–ø—Ä–æ—Å–∞
            st.write("üîç –ó–∞–ø—Ä–æ—Å –∫ Bybit API:")
            st.code(f"{url}?{requests.Request('GET', url, params=params, headers=headers).prepare().url}")
            
            resp = requests.get(url, params=params, headers=headers, timeout=10)
            resp.raise_for_status()  # –≤—ã–∑–æ–≤–µ—Ç –∏—Å–∫–ª—é—á–µ–Ω–∏–µ –ø—Ä–∏ 4xx/5xx
            
            # üîç –û—Ç–ª–∞–¥–∫–∞: –ø–æ–∫–∞–∂–µ–º —Å—ã—Ä–æ–π –æ—Ç–≤–µ—Ç
            st.write("üì¶ –°—ã—Ä–æ–π –æ—Ç–≤–µ—Ç –æ—Ç Bybit:")
            st.code(resp.text[:500])  # –ø–µ—Ä–≤—ã–µ 500 —Å–∏–º–≤–æ–ª–æ–≤
            
            data = resp.json()
            
            if data.get("retCode") != 0:
                st.error(f"‚ùå Bybit API –æ—à–∏–±–∫–∞: {data.get('retMsg', '–ù–µ–∏–∑–≤–µ—Å—Ç–Ω–æ')}")
                st.stop()
            
            candles = data["result"]["list"]
            prices = [float(c[4]) for c in candles]  # –∑–∞–∫—Ä—ã—Ç–∏–µ
            
            # –§–æ—Ä–º–∏—Ä—É–µ–º —Å—Ç—Ä–æ–∫—É –¥–∞–Ω–Ω—ã—Ö –¥–ª—è Gemini
            data_str = "\n".join([
                f"–í—Ä–µ–º—è: {c[0]}, O: {c[1]}, H: {c[2]}, L: {c[3]}, C: {c[4]}"
                for c in candles[-10:]  # –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —Å–≤–µ—á–µ–π –¥–ª—è –∫—Ä–∞—Ç–∫–æ—Å—Ç–∏
            ])
            
            # –ù–∞—Å—Ç—Ä–æ–π–∫–∞ Gemini API
            api_key = os.getenv("GEMINI_API_KEY")
            if not api_key:
                st.error("‚ùå –ù–µ –∑–∞–¥–∞–Ω GEMINI_API_KEY –≤ Secrets. –î–æ–±–∞–≤—å—Ç–µ –µ–≥–æ –≤ Settings ‚Üí Secrets –Ω–∞ Streamlit Cloud.")
                st.stop()
                
            genai.configure(api_key=api_key)
            model = genai.GenerativeModel("gemini-1.5-pro")
            
            prompt = f"""
            –ü—Ä–æ–∞–Ω–∞–ª–∏–∑–∏—Ä—É–π –ø–æ—Å–ª–µ–¥–Ω–∏–µ 10 —á–∞—Å–æ–≤—ã—Ö —Å–≤–µ—á–µ–π {symbol} –Ω–∞ Bybit.
            –î–∞–π –∫—Ä–∞—Ç–∫–∏–π —Ç–µ—Ö–Ω–∏—á–µ—Å–∫–∏–π –∞–Ω–∞–ª–∏–∑: —Ç—Ä–µ–Ω–¥, –≤–æ–∑–º–æ–∂–Ω—ã–µ —Ç–æ—á–∫–∏ –≤—Ö–æ–¥–∞, –ø–æ–¥–¥–µ—Ä–∂–∫–∞/—Å–æ–ø—Ä–æ—Ç–∏–≤–ª–µ–Ω–∏–µ.
            –î–∞–Ω–Ω—ã–µ (–≤—Ä–µ–º—è –≤ Unix ms, O, H, L, C):
            {data_str}
            """
            
            response = model.generate_content(prompt)
            analysis = response.text
            
            st.success("‚úÖ AI-–∞–Ω–∞–ª–∏–∑ –æ—Ç Gemini:")
            st.markdown(analysis)
            
        except Exception as e:
            st.error(f"‚ùå –û—à–∏–±–∫–∞: {str(e)}")
üîÑ –®–∞–≥ 2: –û–±–Ω–æ–≤–∏—Ç–µ —Ñ–∞–π–ª –Ω–∞ GitHub
–ü–µ—Ä–µ–π–¥–∏—Ç–µ –≤ —Ä–µ–ø–æ–∑–∏—Ç–æ—Ä–∏–π bybit-gemini-trading
–û—Ç–∫—Ä–æ–π—Ç–µ app.py
–ù–∞–∂–º–∏—Ç–µ ‚úèÔ∏è (Edit)
–í—Å—Ç–∞–≤—å—Ç–µ –æ–±–Ω–æ–≤–ª—ë–Ω–Ω—ã–π –∫–æ–¥
–ù–∞–∂–º–∏—Ç–µ ¬´Commit changes¬ª
üöÄ –®–∞–≥ 3: –ü–µ—Ä–µ–∑–∞–ø—É—Å—Ç–∏—Ç–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –Ω–∞ Streamlit
–ù–∞ Streamlit Cloud ‚Üí –≤—ã–±–µ—Ä–∏—Ç–µ –≤–∞—à–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–µ
–ù–∞–∂–º–∏—Ç–µ ¬´Redeploy¬ª
–ü–æ–¥–æ–∂–¥–∏—Ç–µ 1‚Äì2 –º–∏–Ω—É—Ç—ã
‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞
–¢–µ–ø–µ—Ä—å:

–ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ –∫–Ω–æ–ø–∫–∏ ‚Äî –¥–æ–ª–∂–µ–Ω –ø–æ—è–≤–∏—Ç—å—Å—è –∑–∞–ø—Ä–æ—Å —Å User-Agent
–ï—Å–ª–∏ Bybit —Ä–∞–∑—Ä–µ—à–∏–ª –¥–æ—Å—Ç—É–ø ‚Äî –≤—ã –ø–æ–ª—É—á–∏—Ç–µ –¥–∞–Ω–Ω—ã–µ –∏ –∞–Ω–∞–ª–∏–∑ –æ—Ç Gemini
–ï—Å–ª–∏ –≤—Å—ë —Ä–∞–≤–Ω–æ 403 ‚Äî –∑–Ω–∞—á–∏—Ç, Bybit –∑–∞–±–ª–æ–∫–∏—Ä–æ–≤–∞–ª IP Streamlit ‚Äî —Ç–æ–≥–¥–∞ –Ω—É–∂–Ω–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WebSocket –∏–ª–∏ –ø—Ä–æ–∫—Å–∏ (—Å–ª–æ–∂–Ω–µ–µ)
üí° –ê–ª—å—Ç–µ—Ä–Ω–∞—Ç–∏–≤–∞: –ò—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å WebSocket (–¥–ª—è —Ä–µ–∞–ª—å–Ω–æ–≥–æ –≤—Ä–µ–º–µ–Ω–∏)
–ï—Å–ª–∏ —Ö–æ—Ç–∏—Ç–µ ‚Äî —è –º–æ–≥—É –ø–æ–º–æ—á—å –≤–∞–º –ø–µ—Ä–µ–π—Ç–∏ –Ω–∞ WebSocket Bybit, –∫–æ—Ç–æ—Ä—ã–π —Ä–∞–±–æ—Ç–∞–µ—Ç –±–µ–∑ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏–π (–Ω–æ —Ç—Ä–µ–±—É–µ—Ç –±–æ–ª—å—à–µ –∫–æ–¥–∞).

–ü—Ä–æ—Å—Ç–æ —Å–∫–∞–∂–∏—Ç–µ:
üëâ ¬´–°–¥–µ–ª–∞–π –≤–µ—Ä—Å–∏—é —Å WebSocket¬ª

–ò–ª–∏
üëâ ¬´–Ø —Ö–æ—á—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥—Ä—É–≥–æ–π –∏—Å—Ç–æ—á–Ω–∏–∫ –¥–∞–Ω–Ω—ã—Ö (–Ω–∞–ø—Ä–∏–º–µ—Ä, Binance)¬ª

üßë‚Äçüíª –í—ã –ø–æ—á—Ç–∏ —É —Ü–µ–ª–∏!
–í—ã —É–∂–µ –ø—Ä–æ—à–ª–∏ –ø—É—Ç—å –æ—Ç 404 –¥–æ —Ä–∞–±–æ—á–µ–≥–æ AI-–ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è ‚Äî –æ—Å—Ç–∞–ª–æ—Å—å –≤—Å–µ–≥–æ –Ω–µ—Å–∫–æ–ª—å–∫–æ —à–∞–≥–æ–≤.

–ï—Å–ª–∏ –ø–æ—Å–ª–µ —ç—Ç–æ–≥–æ –≤—Å—ë —Ä–∞–≤–Ω–æ –±—É–¥–µ—Ç 403 ‚Äî –ø—Ä–∏—à–ª–∏—Ç–µ —Å–∫—Ä–∏–Ω—à–æ—Ç —Å—ã—Ä–æ–≥–æ –æ—Ç–≤–µ—Ç–∞ –æ—Ç Bybit ‚Äî –∏ —è –ø–æ–º–æ–≥—É –Ω–∞–π—Ç–∏ –æ–±—Ö–æ–¥–Ω–æ–π –ø—É—Ç—å.
